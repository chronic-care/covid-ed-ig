import pandas as pd


def read_input(path_to_input):
    return pd.read_csv(path_to_input)


def create_json_from_df(df):
    output = []
    for index, row in df.iterrows():
        if row["Code"] not in existing_codes:
            output.append({
                "system": "http://snomed.info/sct",
                "code": f"{row['Code']}",
                "display": row["Code Title"]
            })
    return output


existing_codes = ['105401000119101', '111307005', '111552007', '123763000', '127012008', '1481000119100', '190368000', '190372001', '190389009', '190407009', '190410002', '190412005', '190416008', '190447002', '199229001', '199230006', '199231005', '23045005', '237599002', '237600004', '237601000', '237604008', '237612000', '237613005', '237617006', '237619009', '237651005', '237652003', '24203005', '2751001', '28032008', '31321000119102', '313435000', '313436004', '33559001', '359642000', '367391000119102', '368101000119109', '368521000119107', '408539000', '408540003', '413183008', '426705001', '426875007', '427089005', '42954008', '44054006', '445260006', '46635009', '51002006', '530558861000132104', '5368009', '57886004', '59079001', '5969009', '609561005', '609562003', '609565001', '609568004', '609569007', '609570008', '609571007', '609572000', '609573005', '609574004', '609575003', '609576002', '609577006', '609578001', '703136005', '703137001', '703138006', '70694009', '720519003', '721088003', '722206009', '722454003', '724067006', '73211009', '733072002', '734022008', '737212004', '75524006', '75682002', '782755007', '782825008', '783722008', '81531005', '816067005', '8801005', '91352004']


if __name__ == "__main__":
    import json
    df = read_input("input/example-input.csv")
    output = create_json_from_df(df)
    with open('output/data.json', 'w') as f:
        json.dump(output, f)
